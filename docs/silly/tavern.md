# 酒馆介绍——萌新向

!!! note "作者：云边（windcloudmoon）"

	[类脑反馈地址](https://discord.com/channels/1134557553011998840/1319538161906356337)
	不能确定萌新有多新——不只是指AI聊天，还有关于网页、计算机网络、数据传输、大模型、各种计算机语言的一小块内容（xml、css、正则等等）……啊，这些东西通通没必要，因为你只是一个来玩的萌新!虽然了解它们有助于你更快自主了解上手各种内容
	
!!!info "分支"
	
	酒馆开发分为两个分支，一个为release，即稳定版，修改更新频率偏慢；一个为staging，为测试版，开发团队会在这个分支上高频更新新版本，修bug，加功能，有一定积累后才会更新稳定版。二者没有严格的优劣好坏之分，但是由于更新过快（ai发展快速也是一部分原因），会出现不同版本的功能有不兼容的情况，一些以前的预设、说明、酒馆界面的部分功能或许不会适用或者使用时有bug，所以还是推荐大家及时更新酒馆

酒馆是一个可以连接各种AI模型使用的网页平台，未来可能会做成APP，现在的酒馆更像是APP的裸露版，提供了很多功能接口，但是没有封装，可以直接看到/修改设置项而非普通APP那样只需要点点按钮就能完成操作。如果不自己做个性化修改的话，在了解如何导入文件和文件种类后的使用体验和正常APP基本一致。如果你知道github，那么可以继续了解到酒馆也是一个在gihub上开发的开源项目，而我们平时使用酒馆就是把这个项目下载/拉取到本地（自己的手机/平板/电脑等能够存储和运行的电子设备）进行使用。

## 使用酒馆聊天

- 在此我进行以下假设
	* 使用酒馆的目的是文字聊天：即交替和AI发送文字消息
	* 已经能够与AI建立稳定的链接：即你发送的消息AI可以接受，AI发送的消息你可以接收
- 这两个假设将教程限制在无扩展功能（如画图、语音等）、
	* 无获取各类AI模型和具体连接的方法介绍上（会介绍连接界面）

- 一般所有人第一次安装成功打开酒馆后会看到如下界面（左图电脑，右图手机）：

![imh](tavern/main.jpg){ loading=lazy align=left }
![img](tavern/phone.jpg){ loading=lazy align= right }
以左图为例，上方白色条中的九个图标为主菜单，下方白色条中的左侧两个图标也属于菜单，但功能不同，后续会详细说明。

- 通常，社区聊天中对这些菜单的图标会依次称其为（如右图所示）：预设/破限、插头、A 、世界书、用户设置、图片、三个小方块堆起来（扩展）、笑脸（用户）、角色（角色设置）

- 下方图标称呼（从左至右）：三横线/三横杠、魔术棒、小飞机/纸飞机/发送

从这些称呼中可以看出，主要从图标样式和实际功能代指它们以在沟通中达成共识
以下为各菜单区功能的一句话简介：

- 预设/破限：可以导入文件，其中有规范的指令指导AI回复（预设）和防止AI道歉（破限），预设为主体,破限通常为指令中的一部分,可能单独可能与预设混合也可能没有。因此两种称呼时有混用

- 插头：连接模型（红色带感叹号代表不能与AI建立链接，不符合前述第二假设，无法聊天）

- A：高级文本设置。太高级、不会、没用、非萌新向，不用管不用动

- 世界书：像书一样方便你写入一类信息并存储，提供结构组织功能，像书一样每本是独立的，这是针对你的理解而非AI

- 用户设置：类比理解为每个APP都存在的账户、设置等内容，可以管理用户信息，提供个性化设置，如各个区域的颜色设置，UI显示设置等等

- 图片：仅仅是用作背景的图片，会做为底图填充整个界面，等价于手机/电脑壁纸

- 扩展：有诸多功能组成的二级菜单，常用的有安装扩展、快速回复、正则。

- 用户：特指聊天时你的身份，可以在这里创建多个身份并管理切换

- 角色设置：特指聊天时AI模型用于和你的角色对话的身份，可以在这里导入创建管理角色卡。

**因此，基础使用就只需要连上AI模型、新建一个角色卡(什么都不填就起一个名字就行）、给自己创建一个身份（最基础的只填一个名字）、点击这个角色条目四步，酒馆就可以新建一个聊天界面，你就可以和AI进行聊天，和在官方网站聊天一样，十分简单~**

## 接下来，开始进阶：
1. 我想它回答得长/有文采/聊瑟瑟/像写小说/像语聊==想要某种特定风格/范式的回答==添加预设破限
2. 我想它作为小说角色/动漫角色/我的OC/原创角色和我玩角色扮演  或者 想要它帮我写作业/解答 ==想要AI作为某一特定身份回应==添加角色卡
3. 我想它在回复时加入xx/给它加世界观/对xx进行强化==想让AI对某个内容有特定理解==添加世界书（又名知识书）
4. 我想让回复时不要出现xx/这前面一大段是什么/……==针对特定文字处理==添加正则

**以上为问题==归纳==解决方案，所有的添加内容均是导入文件，或者自行新建，除角色卡会有图片格式外，文件均为json格式，**

!!! tip "关于正则"

	正则常常会在各种文件中附带需要导入，例如一个预设文件搭配三个配套的正则文件，注意查阅作者介绍，区分不同文件，分别导入对应位置

## 酒馆各常见图标及功能简介汇总


??? info "**可以自行意会的萌新可跳过此处，是电脑也不用看，部分UI鼠标悬停会出现文字说明(展开查看更多)**"

	- 这是聊天界面的图标：

	![img](tavern/chat.jpg){ loading=lazy }

	- 这是各个菜单界面的有关图标：

	![imh](tavern/menu.jpg){ loading=lazy }
	![im](tavern/connect.jpg){ loading=lazy }
	![im](tavern/form.jpg){ loading=lazy }
	![im](tavern/work.jpg){ loading=lazy }
	![im](tavern/per.jpg){ loading=lazy }
	![im](tavern/char.jpg){ loading=lazy }

## 部分名词解释

- DC：Discord软件简称，在谷歌商店或官网可以下载。
- 类脑：Discord上的开源AI简中社区，是酒馆爱好者聚集地，禁止商业行为，强调版权意识，推崇原创与共享。
- AI/模型：指的是由人工智能驱动的模型，可以进行各种任务，例如文本生成、图像处理等。
- 语义：指AI理解和处理语言的方式，关注的是语言背后的意思而非单纯的词汇。
- Api：应用程序接口（API），是软件系统之间交互的标准协议。它允许不同的软件应用互相通信并交换数据。
- Cookie：存储在用户设备上的小段数据，通常用于保存用户的偏好设置或身份信息。
- Clewd：一个Github上的项目，可以利用cookie帮助访问需要身份认证的服务。
- 小克/克劳德/Claude：指Claude模型的昵称，是由A社开发的一个AI模型。
- A社：Claude模型的官方公司简称，指的是Anthropic公司。
- Gemini/哈基米：谷歌推出的最新AI模型的简称/爱称。
- DS：Deepseek的简称，一款强大的搜索引擎或工具，通常用于特定AI数据的查找。
- Cur逆向：一种逆向工程技术，通常用于探索和分析系统、程序或服务的行为，尤其是AI系统的细节。
- 公益站：提供免费AI使用渠道的站点,通过爱心捐赠支持运营者，无偿提供服务，通常依赖志愿者的时间、精力和资金支持。
- 渠道：指通过不同的途径、平台或服务访问模型或信息的路径。
- 模型：指人工智能的算法、架构和训练方法，通过这些模型，AI能够理解和生成语言或执行任务。
- 审查：对内容的监管和控制，通常指对不安全、不合适或违反规则的内容进行拦截或过滤。
- 截断：当生成内容的长度超过了模型的限制时或者被审查时，AI会自动切割或忽略超出的部分，确保回复在设定的范围内。
### 道歉：
- 硬道歉：模型拒绝生成不安全或不合适的内容，通过明确的道歉声明进行反馈。
- 软道歉：回避某些敏感话题或内容，表面上生成正文内容，但情节上避免了不安全或敏感的部分。
- 黄标：官网上的黄色警告标识，通常提示内容可能违反了平台的使用规则或隐私政策。
- 降智：指模型的生成质量因某些原因而下降，可能由于超负荷的运算、硬件限制或模型本身的限制。
- Thinking/COT：指引AI进行思考，指导模型如何在回复之前进行自我推理或拆解问题。
- 文风：AI生成内容时所采用的表达方式和风格。
- 宏：指在模板中使用的占位符，例如{{user}}，会在实际执行时自动替换为你为自己设置的名称或其他动态内容。
- 快速回复/QR：预设的代码片段，当用户点击按钮时触发，快速生成预设的回复内容或者完成某个操作。
- 美化：酒馆界面调整,通常是为了提升用户体验或界面美观进行的细节修改。
- 前端：指网站或应用程序的用户界面部分，用户能够直接交互的部分。
- 前端助手：一种前端的插件或工具，通常安装在浏览器扩展中，帮助用户进行UI调整、辅助功能或快捷操作。在类脑看到的前端助手是大佬写的github项目，作为插件安装在扩展中，实现前端脚本（如美化、手机界面、编辑世界书、导入快速回复等）运行，为酒馆角色卡编写提供额外支持
- 帮助文档：提供用户指导和操作说明的文档，帮助用户理解如何使用酒馆的各项功能。
- 前台：指当前展示在手机或网页上的界面，也叫酒馆页面。与后台相对，后台是程序和服务的运行区域。
- 小作文：通常指短小的文本内容，用户输入后生成的简短文章或句段。
- 提示词后处理：指对发送给ai的内容（提示词）进行的处理
- 摘要：对长篇内容进行简化和提炼，提取出主要信息或核心观点。
- 总结：对内容或事件的总结性陈述，通常用于简洁地回顾重点。
- 状态栏：界面底部显示的区域，通常用来展示操作进度、通知或当前系统状态，一般会用在ai回复里，用<statusblock>包裹。
- roll：刷新回复（具体请参照酒馆聊天部分）

## 正式的酒馆功能介绍
### 预设/破限:

导入破限/预设通常会附带正则，可能还需要导入快速回复（QR）或者其它文件，需要按作者说明操作，找到最新版文件，不要遗漏。不同预设因为作者写预设时的语句、用词、倾向等等，AI呈现的风格也不尽相同，可以多多尝试比较选择自己喜欢的。
一般情况/对萌新而言，破限/预设处无需任何调整即可正常使用，作者有额外说明除外
这个界面可大致分为四个部分，依次介绍（会借用两位大佬的预设）

### 了解破限/预设

不用了解了，直接去下载用吧

### 字符长度相关
- 上下文长度：
准确来说应该是上文长度，越长ai回复时看到的内容就越多，那自然可以参考的信息就越多。把ai接受上下文当成你在考试做阅读理解，只能从头到尾看一遍，那么你出现的问题就是ai会出现的问题。
- 最大回复长度：
答题纸为格子型，不能挤占格子，超了没地儿写，最大回复长度设置太大没有意义，因为模型可能不会写那么多
- 备选回复
官网模型一般都不支持，可以查看官方对模型的说明文档
- 流式传输：
你是监考老师，开启后你看着它答题，也就是ai回复多少就可以看多少；没有开它交卷后你才看到答题结果，只能等ai全部生成完才能收到回复结果


??? info "部分因长度产生的问题举例："

	a. 上下文太长（报错 promot is too long）：一口气读完所有内容，没气憋死了。claude普通cookies不能超过25k，Gemini的有效注意力一般在40k左右，不排除奇迹发生突然出了一个翻旧账的回复

	b. 内容混乱：你在做外国文学阅读理解，看到了一堆家族人名，最后做题时不能回头看文章写出的答案

	c. 没有按逻辑变化（比如一些数值）：超长篇阅读时出现的忽大忽小的数字，题目：请你分析接下来的情景下的数字时你的答案（ps：你记忆力绝佳，不会忘记所有数字只记住最新的）。这也是时间这类规律变化的内容呈现效果更好的原因。

	d. 重复：题目：本题要求写1000字回答，请作答，你能写完，写到最后时能记住前面的内容并保持一致吗？（这里的解决方式：思维链（cot），人话可以说是写作前的大纲）如果你是个差生写不完，后面你是不是会水字数？AI同理
	
	e. 红色框的警告（token budget）：上下文长度太小，不足以向AI发送所有的必要内容，就会警告，发送时AI不会回复，聊天界面上会出现报错信息

### 调整回复稳定
不同模型参数不同，不同参数作用不同，破限作者一般会调好不用动，自己也可微调。但是由于模型和模型所在公司做的限制，这些参数的调整未必有效。
- 举例：温度。
参数数值大小会让模型回复或者刷新回复（roll）时，稳定写同一个答案到天马行空的答案====温度低到高

**补充** ：使用clewd和claude cookies没有温度参数，因为官方禁止传递这个参数，所以设多少都没有用
根据酒馆官方文档搬运的其它参数介绍：

- Top-k : 将令牌池限制为 K 个最有可能的令牌。数字越小，一致性越高，但创造性越低。将该值设置为 0 可禁用其效果。举例说明就是ai对你的回复在只有一个字的情况下，ai可能从K个字中选一个回复
- Top-p : 将令牌池限制为其概率加起来等于 P 所需的令牌数。较低的数字更一致，但缺乏创造力。将值设置为 1 可禁用其效果。举例说明：ai对某句话的回复可能性有五种，如果50%回复a，30%回复b，10%回复c，6回复d%，4%回复e，那么设置为96%，ai会在abcd中选一种而不会考虑e
- 频率惩罚：尝试通过根据标记在上下文中出现的频率对其进行惩罚来抑制重复。
	* 有时，如果角色专注于某件事或重复相同的短语，增加此参数会有所帮助。

	* 如果设置过高，此参数将中断响应。将值设置为 1 可禁用其效果。

- 存在惩罚：上次生成的标记中有多少个标记将被视为重复惩罚。如果设置得太高，可能会破坏响应，因为“the、a、and”等常用词将受到最大惩罚。将该值设置为 0 可禁用其效果。

!!! example "下图为gemini参数（上，3个），claude参数（下，4个）"

	![imh](tavern/gemini.jpg){ loading=lazy }
	![img](tavern/claude.jpg){ loading=lazy }

## 第三部分

这里它自己写了解释，可以根据解释理解。快速提示词部分其实是把预设的一部分提示词通过这个窗口可以直接查看编辑，意义不大
### 预设具体条目

- 以默认default为例讲解：
预设里的条目就是会发送给ai的全部内容，也就是上下文，如果里面的内容超过模型上下文模型会报错，如果超过设置的上下文长度，酒馆会报错。条目从上到下的内容会依次在点击发送键（飞机图标）发送给ai，其中如果超出长度，只会从chat history处删减（在聊天界面的楼层之间可以看到一条虚线，虚线前的内容就是在发给ai时丢了的=ai不会有虚线前内容的记忆）。条目里面可以填充具体的提示词，有的条目(word info, char Description等等）是在其他的地方填写（对应是世界书、角色设定）就不能在此处修改，点击条目后的弹出窗口内没有提示词详情。

- 补充点：
	- a. 预设/破限作者通常会用各种方式将各个条目里面的内容包裹并加上xml标签（类比快递理解）常见方式：<thinking>具体内容</thinking>这种方式可以嵌套（大包裹里装小包裹），优点，调理清晰，大对小有全局、局部效果。不想某个部分起效果就把这个“包裹”关掉，体现为关闭条目右侧开关，条目变暗。

	- b. 条目里的标题是给你看的，方便你理解处理，标签在内容里，需要点击条目才能查看标签和具体信息

	- c. 同种类型或者作用的标签最好只有一个，不然容易冲突：你不能既命令ai先迈左脚，又命令ai先迈右脚，ai不会质疑，执行结果显而易见。还有一种情况是破限作者的破限方式都有固定的格式，一旦有冲突或者关闭了不能关的条目导致格式残缺，就会降低破限效果。

	- d. 标签命名不是随便取的，和代码里面的变量名一样，不会让人看不懂理解不了，大佬一般用英文写的（中文也可以），理解一下就是内容里的命令是关于什么的了。比如<thinking_format>是指导ai如何思考，<writing>是指导ai如何写作等等。
此外，一个常见的词cot，为链式结构，让ai一步步跟着提示做，step by step，没有什么具体含义或者说是使用赋予含义。
（<…>中起名不可包含空格，ai有概率因为空格无视这个标签内的内容，建议下划线连接）

	- e. 为什么部分有红色链接，部分没有：因为新建预设时会提供基础条目（不能删），不够用自己加条目就要用链接加到下方条目栏呈现

### 插头

作用是连接ai模型，具体连接方法不在我这里介绍了。
这里讲几个关联存储的内容吧：
- 你可以在预设、插头、反代处分别看到保存按钮。
这些保存就像是在数据库对您当前的设置内容按名称，设置项的组合进行了一条存储，后续通过点击下拉列表的选项（名称）时，会根据这一条对应的设置项的组合快速切换设置。切换预设时会同时切换预设对应在插头里的所有设置，切换插头顶部那一行的菜单时也是如此，只有反代处切换只会切反代，所以有时候会出现反代名称和当时设置的内容不匹配的情况，再切换一下就好了。

### 提示词后处理

> 不同的模型对对话有不同的要求，以deepseek-r1为例，严格要求消息中各角色消息顺序必须为：系统提示词全部在最前面，然后user发送第一条消息，user与char角色消息互相交替，不能出现某个角色连续发送两条消息的情况，且最后一条消息必须为user发送的，那么这种情况下就需要选择严格提示词后处理，避免报错。

### 世界书

#### 插入位置
- 在角色描述和场景之前插入世界信息条目。对对话有中等影响。

	- 在角色描述和场景之后插入世界信息条目。对对话有较大影响。

- 示例消息之前：世界信息条目被解析为示例对话框，并插入到角色卡提供的示例之前。

	- 示例消息之后：世界信息条目被解析为示例对话框，并插入到角色卡提供的示例之后。

- AN 顶部：世界信息条目插入到作者注释内容的顶部。根据作者注释的位置，其影响各不相同。
- AN 底部：世界信息条目插入到作者注释内容的底部。根据作者注释的位置，其影响各不相同。
- @ D：世界信息条目插入聊天中的特定深度（深度 0 是提示的底部）。
⚙️ - 作为系统角色消息
👤 - 作为用户角色消息
🤖 - 作为助手角色的消息
示例消息条目将根据提示构建设置进行格式化：指示模式或聊天完成提示管理器。它们还遵循示例消息行为规则：在完整上下文中逐渐推出、始终保留或完全禁用。
如果您的作者注释被禁用（插入频率 = 0），A/N 位置中的世界信息条目将被忽略！

!!!tips "开关"

	在条目标题右侧有一个蓝色圈（蓝灯），还可以替换为绿圈(绿灯）、链接符号，分别代表常驻、条件显示和向量显示。蓝灯的内容会一直显示在消息中，绿灯的内容需要设置关键字，只有当你的消息中包含该关键字时才会出现在发送给ai的消息中，向量显示是让AI理解内容中的语义，需要用模型处理，效果不是很明显和稳定。

### 用户设置
官方文档有UI设置的解释页面，直接搬运的：

1. 主题颜色上面一部分不介绍了，默认有五个主题，可以自建或导入主题，最近的妆宜杯让美化区活跃很多，可以自行挑选喜欢的主题下载导入。

2. 主题颜色：
可以按喜好进行调色美化。
UI背景是点击上方UI和整体边框的背景颜色
聊天区有三层，从下至上分别为：图片背景、聊天背景、用户/AI消息模糊色调
后面两层都是纯色，可调透明度，点击色块即可调色
调色需要美商，调完后需要保存，不然重启就没了

3. 滑动条：
聊天宽度：整个界面（主UI下方）的宽度，手机edge等浏览器开适配可能让它失效
字体比例：可以调整字体大小
模糊强度：整体模糊，调高看不清背景图片，禁用模糊会让运行稍稍快一点
文本阴影宽度：字面意思，在文字周围加一圈阴影

4. 勾选框：
- 第一组主题，字面意思可以理解，有一部分开关没有什么效果，不要纠结
#### 部分解释：

- 视觉小说模式：聊天界面降低，展示70%的背景图

#### 第二组，角色处理
关于角色卡导入和角色页面展示时的选项

- 角色列表子标题：选择在角色名称下显示的附加信息角色列表：
	- 角色版本
	- 创建者

- 导入卡片标签：控制导入角色卡时如何处理标签：

	- 询问 - 每次导入时显示对话框
	- 无 - 不导入任何标签
	- 全部 - 导入所有标签
	- 现有 - 仅导入已存在的标签

- 高级字符搜索：启用后，使用模糊匹配并搜索所有字符数据字段，而不仅仅是名称。

- 首选角色提示：如果启用，则在可用时使用角色卡的系统提示覆盖。

- 首选角色说明：如果启用，则在可用时使用角色卡的后历史说明覆盖。
永不调整头像大小：防止对导入的角色图像进行裁剪/调整大小。禁用后，图像将调整为 512x768显示头像文件名：显示角色列表中角色头像的实际文件名。

- 无剧透模式：将角色定义隐藏在编辑器面板中的剧透按钮后面。

#### 第三组，杂项：

- 重新加载聊天：重新加载并重新绘制当前聊天。
- 调试菜单：访问调试选项。
- 流畅流：实验性功能，可使文本生成更加流畅。包括速度控制滑块。
- 消息声音：消息生成完成时播放声音。
- 仅背景声音：仅在浏览器选项卡未聚焦时播放声音。
- 放宽 API URL：减少 API URL 的格式要求。
- 知识书导入对话框：导入嵌入传说的人物时，显示世界信息/传说书的导入对话框。
- 自动选择输入文本：单击时自动选择某些输入字段中的文本。
- Markdown 热键：启用 Markdown 格式化的键盘快捷键。
- 恢复用户输入：刷新页面时保留未保存的用户输入。
- MovingUI：允许通过拖动重新定位 UI 元素（仅限 PC）。
- 重置按钮恢复默认位置（reset）
用于保存/加载 UI 布局的预设系统

#### 信息显示设置
- 控制聊天界面中消息的加载和显示方式。这些设置会影响整体聊天体验和性能。

- 要加载的消息数：分页前要加载的聊天历史消息数（0 = 全部）,针对那些可以聊几百楼的，加载少一些
流式 FPS：流式文本的更新速度（5-100 FPS）
- 示例消息行为：
逐步推出
始终包含示例
切勿包含示例

- 输入和响应控制
确定如何发送消息以及 AI 如何继续响应的设置。
输入发送：选择禁用、自动 (PC) 或启用
“发送”继续：使用“发送”按钮继续 AI 响应
快速“继续”按钮：显示按钮以延长AI的最后一条消息
快速“模仿”按钮：显示单消息角色模仿按钮
滑动：显示箭头按钮以选择其他 AI 响应（PC 和移动设备）
手势：启用滑动手势进行生成（仅限移动设备）

- 删除消息前确认：请勾选，否则当你想要删除重roll的某一条消息时，不会出现以下删除该分支还是整条消息的提示，而是把对user的多次回复都删了

- **禁止外部媒体：最好不要勾选，部分前端卡，含界面的，图片都是通过链接从而连外部媒体才显示，禁止后就加载不出来了**

#### CSS:高级功能（一种代码）
简要说明：自定义CSS是用来改变界面外观的工具。你可以用它调节颜色、字体、大小、间距，甚至是添加一些酷炫的动画。它就像是给酒馆的装修方案，别人提供了一个默认样子，但你可以按自己的喜好改成更符合你心情或风格的样子。

比喻版：把你的酒馆界面想象成一本书（或者一幅画），CSS就是一套“上色规则”和“装饰说明”。默认的界面是素描图（没啥装饰）。CSS就像你的调色盘和画笔。比如界面是一张纸，内容是空白的图案，而CSS就是涂颜色、贴亮片的工具，涂成啥样完全由你决定。

那在让ai辅助时，就要用这种思路去描述处理的对象、对象在界面中的代码表示（需要处理的图案）、想要的效果
[附一个相关教程链接](https://discord.com/channels/1134557553011998840/1310996336903979008)

### 正则

#### 常用正则类别介绍
因为同类正则捕获内容基本相同，所以如果有正则匹配到相同的对象进行替换会产生冲突，一般只有一个生效，如果生效的不是你需要的那一个，那么就会出现问题，所以，仅建议开启必要正则，或者你弄懂之后有选择地开启/自行编写正则

- 一般可以分为以下几类：
	- 添加某个内容：一般是在user消息前添加角色身份(role)，和破限有关
	- 删除/隐藏某些内容：一般是用来使酒馆前台（屏幕只能看到正文剧情，删除/隐藏思维链；或者删除,隐藏发给ai的上下文中的无关内容，减少上下文长度
- 折叠内容
	- 有固定格式（实际文本为<detail>和</detail>之间的内容），在前台会被处理为小三角，点击才能展开，这个其实严格意义上不需要配合正则，是酒馆自动处理的，正则通常会与这个结构结合实现某些效果
- 美化
	- 通常是捕获固定内容然后用匹配组匹配,再在替换为中加入渲染代码和匹配组，辅以前端助手，实现美化和特殊界面展示 

#### 了解正则
简：
- 匹配：查找符合条件的部分。
- 替换为：把匹配到的内容替换成你指定的新内容。
- 捕获组：通过 () 包裹的部分，捕获并保存匹配的内容，可以在替换时使用 $1, $2 等进行引用。
#### 测试模式：点击可有两个输入框，可以测试正则效果。
详：
1. 匹配（Match）
匹配是指使用正则表达式去查找字符串中的某个模式（比如字母、数字、特殊符号等）。当正则表达式成功找到符合条件的部分时，就称为“匹配”。
例如，正则表达式 \d{3} 匹配的是三个连续的数字，如果字符串中有 "123" 或 "456"，它们就符合匹配条件。

2. 替换为（Replace）
替换是指使用正则表达式匹配到某个内容后，将其替换成新内容。在酒馆的正则替换框中，替换为输入框就是你要把匹配到的部分替换成的内容。
例如，假设你用正则 \d{3} 去匹配 123-456-789 这个字符串，你的替换内容可以是 XXX，那最终替换后就会变成 XXX-XXX-XXX。

3. 捕获组（Capture Groups）
捕获组是正则表达式中用括号 () 包裹起来的部分。括号内的内容会被捕获并存储，你可以在替换时用这些存储的部分。
捕获组的作用：它允许你将正则表达式中的某部分进行单独提取并在替换中再次使用。
捕获组以 $1、$2、$3 等方式表示，其中 $1 代表第一个括号内匹配的内容，$2 代表第二个括号内匹配的内容，依此类推。

!!! info "举个例子（界面上提供了测试框）："

	假设我们有这个字符串：abc-123-def-456 我们希望匹配这个字符串，并提取其中的数字部分（123 和 456），然后把它们替换成另一个格式。

	正则表达式：(\d+)-(\d+)
	(\d+) 捕获并匹配数字序列。
	这里，我们有两个捕获组：
	第一个捕获组是 123
	第二个捕获组是 456
	在替换框中，我们可以写 $1:$2，也就是将匹配到的数字用冒号连接：
	替换为： $1:$2
	替换后，结果会是：123:456

#### 基础正则介绍
1. 字符匹配
普通字符：最基本的正则表达式匹配就是字符本身。比如，a 匹配字符串中的字母 a。
点号 .：表示任意单个字符（除了换行符）。例如，a.b 可以匹配 acb、a1b 等

2. 字符集（方括号 []）
方括号用来定义一个字符的集合，表示匹配集合中任意一个字符。
[abc]：匹配 a、b 或 c 中的任何一个字符。
[a-z]：匹配任何小写字母。
[A-Z]：匹配任何大写字母。
[0-9]：匹配任何数字。

3. 字符范围（连字符 -）
在字符集内，连字符 - 表示一个范围。
[a-z]：匹配所有小写字母。
[0-9]：匹配所有数字。
[A-Za-z]：匹配所有字母（不区分大小写）。

4. 字符类
\d：匹配一个数字，等价于 [0-9]。
\D：匹配一个非数字字符，等价于 [^0-9]。
\w：匹配一个字母、数字或下划线，等价于 [a-zA-Z0-9_]。
\W：匹配一个非字母、非数字、非下划线的字符，等价于 [^a-zA-Z0-9_]。
\s：匹配任何空白字符，包括空格、制表符、换行符等。
\S：匹配任何非空白字符。

5. 量词
[*]：匹配前面的字符零次或多次。比如，a* 匹配空字符串、a、aa、aaa 等。
+：匹配前面的字符一次或多次。比如，a+ 匹配 a、aa、aaa 等，但不匹配空字符串。
?：匹配前面的字符零次或一次。比如，a? 匹配空字符串或 a。
{n}：匹配前面的字符恰好 n 次。比如，a{3} 匹配 aaa。
{n,}：匹配前面的字符至少 n 次。比如，a{2,} 匹配 aa、aaa 等。
{n,m}：匹配前面的字符至少 n 次，但不超过 m 次。比如，a{2,4} 匹配 aa、aaa 和 aaaa。

6. 位置匹配
^：匹配字符串的开头。比如，^a 匹配以 a 开头的字符串。
$：匹配字符串的结尾。比如，a$ 匹配以 a 结尾的字符串。

7. 分组与选择
()：用于分组，表示把多个字符或表达式作为一个整体来处理。例如，(abc)+ 会匹配 abc、abcabc 等。
|：表示“或”操作，匹配左右两边的表达式中的任意一个。例如，a|b 匹配 a 或 b。

8. 转义字符
\：用于转义特殊字符，使其失去特殊含义。例如，\. 匹配点号 .，\* 匹配星号 *

#### 酒馆的正则设置选项
左侧的勾选框是关于处理对象的，比如勾选用户输入正则就会对用户输入生效，其它三个同理可得
右上方的勾选框
- 已禁用：效果和直接开启关闭正则按钮一样
- 在编辑时运行：
- 替代正则表达式：
3. 右侧下方的勾选框：这里要说明一下——酒馆把一份内容分为了三份：

- ①原始内容②酒馆界面显示③后台发给ai的提示词显示。仅格式……的意思是只处理②或者③，但是原始内容不变。［补：只针对用户输入和ai输出，世界信息和快捷命令不清楚，简单测了下无效，不清楚具体怎么搞］

4. 最小深度x：从当前楼层向0层数，数到x开始处理，不填默认从最新楼层开始； 最大深度d2：从d1开始处理，直到数到d2或者0层结束处理，不填默认处理到0，d1、y为数字












